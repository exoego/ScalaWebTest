---
title: Documentation
description: A comprehensive guide to writing integration tests with ScalaWebTest
twitterAuthor: danireych
---
<!DOCTYPE HTML>
<html lang="en">
{% include head.ext %}
<body>
{% include header.ext %}
<!-- Main -->
<div id="main">
    <div class="container">
        <div class="row">
            <!-- Sidebar -->
            <div id="sidebar">
                <div class="row">
                    <div class="4u">
                        <section>
                            <header>
                                Getting started
                            </header>
                            <ul class="default">
                                <li><a href="#addSWT/sbt">Add ScalaWebTest to your sbt project</a></li>
                                <li><a href="#addSWT/maven">Add ScalaWebTest to your maven project</a></li>
                                <li><a href="#firsttest">Write your first test</a></li>
                                <li><a href="#teststyles">Selecting a style</a></li>
                                <li><a href="#basetrait">Build your base trait</a></li>

                                <li><a href="#config">Configure your tests</a></li>
                            </ul>
                        </section>
                        <section>
                            <header>
                                Writing gauges
                            </header>
                            <ul class="default">
                                <li><a href="#classes">Test for classes on elements</a></li>
                                <li><a href="#contains">Test for containment</a></li>
                                <li><a href="#regex">Test for regex matches</a></li>
                            </ul>
                        </section>
                    </div>
                    <div class="4u">
                        <section>
                            <header>
                                Using advanced features
                            </header>
                            <ul class="default">
                                <li><a href="#javascript">Executing JavaScript</a></li>
                                <li><a href="#responsestatus">Accessing response status</a></li>
                            </ul>
                        </section>
                        <section>
                            <header>
                                Additional modules
                            </header>
                            <ul class="default">
                                <li><a href="#modules">Modules</a>
                                <li><a href="#modules/aem">AEM module</a></li>
                            </ul>
                        </section>
                        <section>
                            <header>Extending ScalaWebTest</header>
                            <ul class="default">
                                <li><a href="#extending">Extending ScalaWebTest</a></li>
                            </ul>
                        </section>
                    </div>
                    <div class="4u">
                        <section>
                            <header>
                                Internal structure
                            </header>
                            <ul class="default">
                                <li><a href="#api/IntegrationSpec">IntegrationSpec</a></li>
                                <li><a href="#api/IntegrationSpec">Integration*Spec</a></li>
                                <li><a href="#api/SpecBehavior">*SpecBehavior</a></li>
                                <li><a href="#api/Matcher">Matcher</a></li>
                                <li><a href="#api/Login">Login</a></li>
                                <li><a href="#api/WebDriver">WebDriver</a></li>
                                <li><a href="#api/WebDriverConfigFixtures">WebDriverConfigFixtures</a></li>
                            </ul>
                        </section>
                    </div>
                </div>
            </div>

            <div id="content">
                <header>
                    <h2 id="getting_started">Getting started</h2>
                </header>

                <h3 id="addSWT">Add ScalaWebTest to your project</h3>
                <p>Before you get to use all the nice features, you have to introduce ScalaWebTest to your project.
                    All you have to do, is add the core module to your test or integration test dependencies.</p>

                <h4 id="addSWT/sbt">Add ScalaWebTest to your SBT project</h4>
                <p>You can add ScalaWebTest to your integration testing dependencies in the build.sbt/scala
                    of your sbt project as follows.</p>
                {% highlight scala %}
libraryDependencies += "org.scalawebtest" %% "core_2.11" % "1.0.2" % "it"
                {% endhighlight %}

                <p>If you want to manage the most important transitive dependencies of ScalaWebTest, you might configure
                    it as follows. Especially selenium-java and selenium-htmlunit-driver should align.</p>

                {% highlight scala %}
libraryDependencies ++= Seq(
    "org.scalawebtest" %% "core_2.11" % "1.0.2" % "it"
    "org.scalatest" %% "scalatest" % "3.0.0" % "it",
    "org.seleniumhq.selenium" % "selenium-java" % "2.53.1" % "it",
    "org.seleniumhq.selenium" % "selenium-htmlunit-driver" % "2.52.0" % "it",
)
                {% endhighlight %}
                <h4 id="addSWT/maven">Add ScalaWebTest to your maven project</h4>
                <p>You have to add the following dependency to your maven project to use ScalaWebTest.</p>

                {% highlight xml %}
<dependency>
    <groupId>org.scalawebtest</groupId>
    <artifactId>core_2.11</artifactId>
    <version>1.0.2</version>
    <scope>test</scope>
</dependency>
                {% endhighlight%}

                <p>In case you want to manage the most important transitive dependencies of ScalaWebTest,
                    you can add our bill-of-materials to your project. You may to so by adding the following dependency</p>

                {% highlight xml %}
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.scalawebtest</groupId>
            <artifactId>bom_2.11</artifactId>
            <version>1.0.0</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>
                {% endhighlight%}


                <h3 id="firsttest">Write your first test</h3>
                To write your first test you have to create a scala file in src/it/scala or src/test/scala,
                depending on your test setup. You then create a class named TestSubjectSpec which extends IntegrationFlatSpec.
                Other <a href="#teststyles">styles</a> are available, if you prefer. Lets assume we want to verify our homepage
                and call the test HomepageSpec

                {% highlight scala %}
class HomepageSpec extends IntegrationFlatSpec {
    override val host = "http://localhost:8080"
    override val path "index.html"

    "Our homepage" should "contain a header with the company name" in {
        webDriver.findElementByTagName("h1").getText shouldEqual "Unic AG"
    }
}
                {% endhighlight%}

                Thats all you need. ScalaWebTest will automatically call http://localhost:8080/index.html before executing a test,
                call "Our homepage" - "should" - "contain a header with the company name". With the test, we can then access elements
                within the webDriver. The webDriver emulates a web browser.

                <h3 id="teststyles">Selecting a style</h3>
                <p>ScalaTest provides a wide variety of testing <a href="http://www.scalatest.org/user_guide/selecting_a_style">styles</a>. ScalaWebTest supports all available styles.
                    As the ScalaWebTest creators have a JUnit background, most of the examples use FlatSpec style. There is no technical reason behind it, it is simply a matter of taste.
                    In your BaseTrait extend one of the Integration*Spec/Suite classes from <a href="https://github.com/unic/ScalaWebTest/blob/master/core/src/main/scala/org/scalawebtest/core/Styles.scala">Styles.scala</a></p>

                <h3 id="basetrait">Build your base trait</h3>
                Configurations, style choice and possible custom extension should be shared across your project. To do so, we recommend
                to create a BaseTrait. When creating a new Test you then simply extend your BaseTrait. You can find such an
                example in ScalaWebTest's own integration tests.

                {% highlight scala %}
trait ScalaWebTestBaseSpec extends IntegrationFlatSpec with AemTweaks with FormBasedLogin {
  override val host = "http://localhost:8080"
  override val loginPath = "/fakeLogin.jsp"

  override val projectRoot = ""

  override def loginTimeout = Timeout(5 seconds)
}                {% endhighlight %}

                This BaseTrait uses FlatSpec style, adds the tweaks from the AEM module, and uses FormBasedLogin.

                <h3 id="config">Configure your tests</h3>
                <p>A reasonable default configuration is provided, which can easily get adapted. If you want to change
                a configuration for all your tests, we recommend to change it in your base trait, otherwise best practice is
                to change it in the constructor of your TestSpec. Two config objects exist, one which is applied during login
                and one which is applied during test execution.</p>

                <p>In the following TestSpec JavaScript errors are swallowed during Login phase, no matter if JavaScript execution is enabled or disable.
                During test execution JavaScript is enabled and JavaScript errors let the test fail.</p>
                {% highlight scala %}
class HomepageSpec extends IntegrationFlatSpec {
    override val host = "http://localhost:8080"
    override val path "index.html"

    loginConfig.swallowJavaScriptErrors
    config.enableJavaScript(throwOnError = true)

    "Our homepage" should "contain a header with the company name" in {
        webDriver.findElementByTagName("h1").getText shouldEqual "Unic AG"
    }
}
                {% endhighlight%}

                <p>By default JavaScript is not executed and JavaScript errors don't throw. Also CSS is not interpreted.
                This applies to both loginConfig and config.</p>

                <h3 id="gauges">Writing gauges</h3>
                <p>Using <b>gauges</b> to write your integration tests, is the core idea of ScalaWebTest. We think using org.scalatest.selenium.WebBrowser.Query, i.e CssSelectorQuery,
                    to select elements in a HTML document and then verifying it is cumbersome and the resulting test is hard to read. Instead we copy a concept from the manufacturing industry.
                    They build gauges, which they then lay their workpiece into. If the workpiece fits in the gauge, it satisfies the requirements. Gauges are defined in HTML
                    (technically speaking it is XML, using <a href="http://www.scala-lang.org/api/2.11.8/scala-xml/?_ga=1.231631391.1228626470.1461659856#scala.xml.NodeSeq">scala.xml.NodeSeq</a>)
                    Let's have a look at a simple example to get an idea how those gauges work.</p>

{% highlight scala %}
package org.scalawebtest.integration.gauge

import org.scalawebtest.core.gauge.Gauge.fit
import org.scalawebtest.integration.ScalaWebTestBaseSpec

class SimpleGaugeSpec extends ScalaWebTestBaseSpec {

path = "/navigation.jsp"

"The navigation" should "contain our navigation links in correct structure, order and with the expected text" in {
    fit(
    <nav id="mainNav">
                <ul class="blue_theme">
                    <li>
                        <a href="/path/to/first/element">first navigation element</a>
                    </li>
                    <li class="active">
                        <a href="/path/to/second/element">second navigation element</a>
                    </li>
                    <li>
                        <a href="/path/to/third/element">third navigation element</a>
                    </li>
                </ul>
            </nav>)
    }
}
{% endhighlight %}

                <p>This test would be successful, when run against, when <i>navigation.jsp</i> contains the following HTML</p>

{% highlight html %}
<!DOCTYPE html>
<html>

<head>
</head>

<body>
    <nav id="mainNav">
        <ul class="blue_theme">
            <li>
                <a href="/path/to/first/element">first navigation element</a>
            </li>
            <li class="active">
                <a href="/path/to/second/element">second navigation element</a>
            </li>
            <li>
                <a href="/path/to/third/element">third navigation element</a>
            </li>
        </ul>
    </nav>
</body>
</html>
{% endhighlight %}

                <p>We can already, see that <i>fits()</i> ignored <i>html</i>, <i>head</i> and <i>body</i>, elements before the navigation.
                    But following the idea from manufacturing, we should strip our <i>gauge</i>, from everything which we don't need.
                    Let's assume we only want to make sure our navigation contains the correct links. We don't care about classes added for design or
                    text contained in the links. Therefore we reduce our test to.</p>
{% highlight scala %}
"The navigation" should "contain our navigation links in correct structure and order" in {
fit(
<nav id="mainNav">
    <ul>
        <li>
            <a href="/path/to/first/element"></a>
        </li>
        <li>
            <a href="/path/to/second/element"></a>
        </li>
        <li>
            <a href="/path/to/third/element"></a>
        </li>
    </ul>
</nav>)
}
{% endhighlight %}
                <p>If we don't care about the unnumbered list, we can reduce our test even further.</p>
{% highlight scala %}
"The navigation" should "contain our navigation links in correct order" in {
fit(
<nav id="mainNav">
    <a href="/path/to/first/element"></a>
    <a href="/path/to/second/element"></a>
    <a href="/path/to/third/element"></a>
</nav>)
}
{% endhighlight %}
                <p>The document then fits our gauge as follows. Matching parts are green, parts in grey have no influence whether the document fits or not.</p>

                <div class="highlight"><pre><code class="language-html" data-lang="html"><span class="n">&lt;!DOCTYPE html&gt;</span>
<span class="n">&lt;html&gt;</span>
    <span class="n">&lt;head&gt;</span>
    <span class="n">&lt;/head&gt;</span>
    <span class="n">&lt;body&gt;</span>
        <span class="s"><b>&lt;nav id=&quot;mainNav&quot;&gt;</b></span>
            <span class="n">&lt;ul class=&quot;blue_theme&quot;&gt;</span>
                <span class="n">&lt;li&gt;</span>
                    <span class="s"><b>&lt;a href=&quot;/path/to/first/element&quot;&gt;</b></span><span class="n">first navigation element</span><span class="s"><b>&lt;/a&gt;</b></span>
                <span class="n">&lt;/li&gt;</span>
                <span class="n">&lt;li class=&quot;active&quot;&gt;</span>
                    <span class="s"><b>&lt;a href=&quot;/path/to/second/element&quot;&gt;</b></span><span class="n">second navigation element</span><span class="s"><b>&lt;/a&gt;</b></span>
                <span class="n">&lt;/li&gt;</span>
                <span class="n">&lt;/li&gt;</span>
                    <span class="n">&lt;li&gt;</span>
                <span class="s"><b>&lt;a href=&quot;/path/to/third/element&quot;&gt;</b></span><span class="n">third navigation element</span><span class="s"><b>&lt;/a&gt;</b></span>
            <span class="n">&lt;/li&gt;</span>
        <span class="n">&lt;/ul&gt;</span>
        <span class="s"><b>&lt;/nav&gt;</b></span>
    <span class="n">&lt;/body&gt;</span>
<span class="n">&lt;/html&gt;</span></code></pre></div>

                <p>If the gauge doesn't fit, we get an error. Lets change the test to the following.</p>
 {% highlight scala %}
"The navigation" should "contain our navigation links in correct order" in {
fit(
<nav id="mainNav">
    <a href="/path/to/first/element">second navigation element</a>
    <a href="/path/to/second/element"></a>
    <a href="/path/to/third/element"></a>
</nav>)
}
{% endhighlight %}
                <p>This will of course not match, because the text within the first link is wrong and belongs to the second link.
                    See the different highlighted in the following html block.</p>
                                <div class="highlight"><pre><code class="language-html" data-lang="html"><span class="n">&lt;!DOCTYPE html&gt;</span>
<span class="n">&lt;html&gt;</span>
    <span class="n">&lt;head&gt;</span>
    <span class="n">&lt;/head&gt;</span>
    <span class="n">&lt;body&gt;</span>
        <span class="s"><b>&lt;nav id=&quot;mainNav&quot;&gt;</b></span>
            <span class="n">&lt;ul class=&quot;blue_theme&quot;&gt;</span>
                <span class="n">&lt;li&gt;</span>
                    <span class="s"><b>&lt;a href=&quot;/path/to/first/element&quot;&gt;</b></span><span class="o"><del>second navigation element</del></span> <span class="gr"><b>first navigation element</b></span><span class="s"><b>&lt;/a&gt;</b></span>
                <span class="n">&lt;/li&gt;</span>
                <span class="n">&lt;li class=&quot;active&quot;&gt;</span>
                    <span class="s"><b>&lt;a href=&quot;/path/to/second/element&quot;&gt;</b></span><span class="n">second navigation element</span><span class="s"><b>&lt;/a&gt;</b></span>
                <span class="n">&lt;/li&gt;</span>
                <span class="n">&lt;/li&gt;</span>
                    <span class="n">&lt;li&gt;</span>
                <span class="s"><b>&lt;a href=&quot;/path/to/third/element&quot;&gt;</b></span><span class="n">third navigation element</span><span class="s"><b>&lt;/a&gt;</b></span>
            <span class="n">&lt;/li&gt;</span>
        <span class="n">&lt;/ul&gt;</span>
        <span class="s"><b>&lt;/nav&gt;</b></span>
    <span class="n">&lt;/body&gt;</span>
<span class="n">&lt;/html&gt;</span></code></pre></div>

                <p>This results in the following error message from ScalaWebTest</p>
                {% highlight text %}
23:06:37.482 [ScalaTest-run-running-SimpleGaugeSpec] INFO IntegrationSpec - Going to http://localhost:8080/navigation.jsp

Misfitting Text: The text [first navigation element] within [HtmlAnchor[<a href="/path/to/first/element">]] didn't equal [second navigation element]
Current document does not match provided gauge:
<nav id="mainNav">
    <ul>
        <li>
            <a href="/path/to/first/element">second navigation element</a>
        </li>
        <li>
            <a href="/path/to/second/element"></a>
        </li>
        <li>
            <a href="/path/to/third/element"></a>
        </li>
    </ul>
</nav>
ScalaTestFailure
                {% endhighlight %}

                <h4 id="classes">Test for classes on elements</h4>
                <p>The class attribute is special, because it is basically an unsorted set of class attributes. Usually
                we don't bother, if additional classes are present in our HTML and for sure we never care about the order.
                ScalaWebTest therefore handles the class attribute different from the rest. Per default the attribute content,
                has to match exactly the one you provided in your gauge, but for classes, it only asserts, that the classes which
                an element contains within your gauge definition, are all present on that element in the HTML document.
                The following gauge therefore matches all the elements shown below.</p>
                {% highlight scala %}
fit(<div class="container red"></div>)
                {% endhighlight %}
                 {% highlight html %}
<div class="container red"></div>
                {% endhighlight %}
                {% highlight html %}
<div class="red container"></div>
                {% endhighlight %}
                {% highlight html %}
<div class="red important container main"></div>
                {% endhighlight %}

                <h4 id="contains">Test for containment</h4>
                <p>It is common that you don't want to verify the complete attribute value, or text of an element.
                You may use <i>@contains</i> to trigger the ContainsMatcher instead of the DefaultMatcher.
                Thanks to this matcher, this gauge matches the following HTML element</p>
                {% highlight scala %}
fit(<a href="@contains ScalaWebTest"></a>)
                {% endhighlight %}
                {% highlight html %}
<a href="https://github.com/unic/ScalaWebTest"></a>
                {% endhighlight %}
                <p>The containsMatcher is also available, when matching text.</p>
                 {% highlight scala %}
fit(<a>@contains available</a>)
                {% endhighlight %}
                {% highlight html %}
<a>ScalaWebTest is available on github</a>
                {% endhighlight %}
                <p>Hint: always add a space after the matcher annotation. We enforce this space to improve readability of tests.</p>
                <h4 id="regex">Test for regex matches</h4>
                <p>When we want to enforce textual rules on our content, we need a more powerful Matcher. The RegexMatcher is our friend.
                It is trigger using <i>@regex</i></p>

                {% highlight scala %}
fit(<a href="@regex http:\\/\\/[a-zA-Z]+\.scalawebtest.org.*,"></a>)
                {% endhighlight %}

                <p>This gauge will fit</p>
                {% highlight html %}
<a href="http://www.scalawebtest.org/documentation.html"></a>
                {% endhighlight %}
                <p>but it won't fit</p>
                {% highlight html %}
<a href="http://scalawebtest.org/documentation.html"></a>
                {% endhighlight %}
            </div>
        </div>
    </div>
</div>
</body>
</html>

